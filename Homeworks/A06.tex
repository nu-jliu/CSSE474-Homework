\documentclass[11pt]{article}

\usepackage{enumitem}


%%TO EDIT
\newcommand{\dueclassnumber}{15}
\newcommand{\assignmentnum}{6}

% CHANGE issolution{0} to issolution{1} for homework submission.
% WRITE solutions inside the \solution{} commands.
% or, you can use \if\issolution1 â€¦ \fi

\def\issolution{1}
\def\myname{Allen Liu} % My name goes here
\def\mysec{01} % Section number goes here
\def\myCM{374} % Campus Mailbox goes here

\input{../common/flags}
\newcommand\vv[2]{\begin{bmatrix} {#1} \cr {#2} \end{bmatrix}}

% Leave the next line alone. This is for my answer keys.
%\def\isanswerkey{1}

\input{../common/header474}
\if\isanswerkey1\input{macsse474-key}\fi


\usetikzlibrary{positioning}

\begin{document}

\assignmentnametitlestuff


\if\isanswerkey0
{\bf Please follow the homework guidelines from A01.}

\fi


\begin{enumerate}

\item (2.12) Convert the following CFG $G$ to an equivalent PDA, using the procedure given in Theorem 2.20 / Worksheet 13.
\begin{align*}
R &\to XRX \mid S \cr
S &\to {\tt a}T{\tt b} \mid {\tt b}T{\tt a} \cr
T &\to XTX \mid X \mid \epsilon \cr
X &\to {\tt a} \mid {\tt b}
\end{align*}
\solution{
\if\isanswerkey1\solConvertCFGToPDA\fi
\begin{tikzpicture}
\node[state, initial] (q0) {$q_0$};
\node[state, below of=q0] (q1) {$q_1$};
\node[state, below of=q1] (q2) {$q_{loop}$};
\node[state, below of=q2, accepting] (q3) {$q_f$};
\node[state, right of=q0] (q4) {$q_4$};
\node[state, right of=q4] (q5) {$q_5$};
\node[state, below of=q5] (q6) {$q_6$};
\node[state, right of=q6] (q7) {$q_7$};
\node[state, below of=q7] (q8) {$q_8$};
\node[state, right of=q8] (q9) {$q_9$};
\node[state, left of=q3] (q10) {$q_{10}$};
\node[state, left of=q10] (q11) {$q_{11}$};
\draw
(q0) edge[below, left] node{$\epsilon, \epsilon \to \$$} (q1)
(q1) edge[below, left] node{$\epsilon, \epsilon \to R$} (q2)
(q2) edge[above, above] node{$\epsilon, R \to X$} (q4)
(q4) edge[right, above] node{$\epsilon, \epsilon \to R$} (q5)
(q5) edge[below, below] node{$\epsilon, \epsilon \to X$} (q2)
(q2) edge[loop left] node{\makecell{$\epsilon, R \to S ~~~\epsilon, T \to \epsilon$ \\ $\epsilon, T \to X ~~~\epsilon, X \to a$ \\ ${\tt a}, {\tt a} \to \epsilon ~~~{\tt b}, {\tt b} \to \epsilon$ \\ $\epsilon, X \to {\tt b}$}} (q2)
(q2) edge[above, above] node{$\epsilon, S \to {\tt b}$} (q6)
(q6) edge[right, above] node{$\epsilon, \epsilon \to R$} (q7)
(q7) edge[below, below] node{$\epsilon, \epsilon \to {\tt a}$} (q2)
(q2) edge[above, above] node{$\epsilon, S \to {\tt a}$} (q8)
(q8) edge[right, above] node{$\epsilon, \epsilon \to R$} (q9)
(q9) edge[bend left, above] node{$\epsilon, \epsilon \to {\tt b}$} (q2)
(q2) edge[below, below] node{$\epsilon, T \to X$} (q10)
(q10) edge[left, below] node{$\epsilon, \epsilon \to T$} (q11)
(q11) edge[right, left] node{$\epsilon, \epsilon \to X$} (q2)
(q2) edge[below, right] node{$\epsilon, \$ \to \epsilon$} (q3)
;
\end{tikzpicture}
}


\item (2.15 and 2.16, modified) 
\begin{enumerate}
\item Give a counterexample to show that the following construction fails to prove that the class of context-free languages is closed under star. Let $A$ be a CFL that is generated by the CFG $G = (V,\Sigma,R,S)$. Add the new rules $S \to SS \mid \epsilon$ and call the resulting grammar $G'$. This grammar is supposed to generate $A^*$.
\solution{
\if\isanswerkey1\solBadProofCFLClosedUnderStar\fi
For the new Grammar $G'$, consider a CFG that contains rule rule $S \to {\tt 0}S{\tt 1} \mid \epsilon$, which gives a string $s={\tt 0}^n{\tt 1}^n$.Adding the rule $S \to SS \mid \epsilon$ will cause the grammar accept the string like ${\tt 001011}$, which is not in form of ${\left({\tt 0}^n{\tt 1}^n\right)}^*$. Hence it fails to prove that CFL is closed under star. 

}
\item Show that the class of context-free languages over an alphabet $\Sigma$ is closed under the regular operations: union, concatenation, and star. (You only need to briefly describe constructions of appropriate CFGs. Note that your solution for star could be a ``corrected" version of the failed idea from (a).)
\solution{
\if\isanswerkey1\solCFLsClosedUnderRegOps\fi
\subsubsection*{Union}
Suppose $A$ is a language that is generated by CFG $G_A=\left(V_A, \Sigma, R_A, S_A\right)$ and $B$ is a language that is generated by CFG $G_B=\left(V_B, \Sigma, R_B, S_B\right)$. Then, there is a CFG $G=\left(V, \Sigma, R, S\right)$ that generates language $A\cup B$. Where 
\begin{itemize}
    \item $V=V_A\cup V_B \cup \left\{S\right\}$ 
    \item $\Sigma$ are all same
    \item \begin{equation*}
        R(v)=\begin{cases}
            R_A(v) & v \in V_A\\
            R_B(v) & v \in V_B\\
            S \to S_A \mid S_B & v=S
        \end{cases}
    \end{equation*}
    \item $S$ is a new start variable
\end{itemize}
\subsubsection*{Concatenation}
Suppose $A$ is a language that is generated by CFG $G_A=\left(V_A, \Sigma, R_A, S_A\right)$ and $B$ is a language that is generated by CFG $G_B=\left(V_B, \Sigma, R_B, S_B\right)$. Then, there is a CFG $G=\left(V, \Sigma, R, S\right)$ that generates language $AB$. Where 
\begin{itemize}
    \item $V=V_A\cup V_B \cup \left\{S\right\}$ 
    \item $\Sigma$ are all same
    \item \begin{equation*}
        R(v)=\begin{cases}
            R_A(v) & v \in V_A\\
            R_B(v) & v \in V_B\\
            S \to S_AS_B & v=S
        \end{cases}
    \end{equation*}
    \item $S$ is a new start variable
\end{itemize}
\subsubsection*{Star}
Suppose $A$ is a language that is generated by CFG $G_A=\left(V_A, \Sigma, R_A, S_A\right)$Then, there is a CFG $G=\left(V, \Sigma, R, S\right)$ that generates language $A^*$. Where 
\begin{itemize}
    \item $V=V_A\cup \left\{S\right\}$ 
    \item $\Sigma$ are all same
    \item \begin{equation*}
        R(v)=\begin{cases}
            R_A(v) & v \in V_A\\
            S \to SS_A \mid \epsilon & v=S
        \end{cases}
    \end{equation*}
    \item $S$ is a new start variable
\end{itemize}
Hence, CFG is closed under operations union, concatenation and star.
}
\item Consider the following grammars:
\begin{center}
$G_\emptyset$: $S \to S$ \qquad $G_\epsilon$: $S \to \epsilon$ \qquad  $G_a$: $S \to a$
\end{center}
It is easy to see that $L(G_\emptyset) = \emptyset$, $L(G_\epsilon) = \{\epsilon\}$, and $L(G_a) = \{a\}$ for any $a \in \Sigma$. What can we conclude from this information, along with part (b)?
\solution{
\if\isanswerkey1\solImplicationOfCFLClosedUnderRegOps\fi
For a language $A=\left\{\Sigma^n\mid n\ge0\right\}$, it can be generated by a CFG, where $L\left(G\right)=A$
}

\end{enumerate}


\item (2.30ad) Use the pumping lemma for CFLs to show that the following languages are not context-free.
\begin{enumerate}
\item $A = \{{\tt 0}^n{\tt 1}^n{\tt 0}^n{\tt 1}^n \mid n \ge 0\}$
\solution{
\if\isanswerkey1\solNotContextFreeA\fi
Suppose language $A$ is a CFL. Let $p$ be the pumping length as in pumping lemma. Consider a string $s={\tt 0}^p{\tt 1}^p{\tt 0}^p{\tt 1}^p \in A$, where $|s|=4p\ge p$. Then the pumping lemma for CFL implies that $s=uvxyz$ as in pumping lemma. Since $|uxy|\le p$, $v$ and $y$ at most contains symbols in one group of ${\tt 0}$s and one group of ${\tt 1}$s. So for pumped string say $s'=uv^2xy^2z$, one group of ${\tt 0}$s or ${\tt 1}$s must have more symbols than other one. Then $s'\not\in A$. Hence, language $A$ is not a CFL. 
}

\item[(d)] $D = \{t_1\texttt{\#}t_2\texttt{\#}\cdots\texttt{\#}t_k \mid k \ge 2, \textnormal{ each } t_i \in \{{\tt a},{\tt b}\}^*, \textnormal{ and } t_i = t_j \textnormal{ for some } i \ne j\}$
\solution{
\if\isanswerkey1\solNotContextFreeD\fi
Suppose language $D$ is a CFL. Let $p$ be the pumping length as in pumping lemma. Consider a string $s={\tt a}^p{\tt b}^p\texttt{\#}{\tt a}^p{\tt b}^p \in D$. Then the pumping lemma for CFL implies that $s=uvxyz$ as in pumping lemma. Since $|uxy|\le p$, $v\in {\tt b}^+$ and $y\in {\tt a}^+$. So by pumping the string, say $s'=uv^2xy^2z$, it has more ${\tt a}$s in $t_1$ than that in $t_2$. So $t_1\ne t_2$, which gives $s'\not\in D$. Hence, language $D$ is not a CFL. 
}
\end{enumerate}
\end{enumerate}

% \subsection*{A07 problem}
% {\em The following problem will be due as part of A07. You can start on it now if you have time. Please do not submit it as part of A06.}
% \vskip.3cm

% (2.48) Let $\Sigma = \{0,1\}$. Let $C_1$ be the language of all strings that contain a {\tt 1} in their middle third. Let $C_2$ be the language of all strings that contain two {\tt 1}s in their middle third. In particular,
% \begin{align*}
% C_1 &= \{xyz \mid x,z \in \Sigma^* \textnormal{ and $y \in \Sigma^*{\tt 1}\Sigma^*$, where $|x| = |z| \ge |y|$}\} \cr
% C_2 &= \{xyz \mid x,z \in \Sigma^* \textnormal{ and $y \in \Sigma^*{\tt 1}\Sigma^*{\tt 1}\Sigma^*$, where $|x| = |z| \ge |y|$}\}.
% \end{align*}
% \begin{enumerate}
% \item Show that $C_1$ is a CFL.
% \item Show that $C_2$ is not a CFL.
% 
% 
% 
% 
% \end{enumerate}





\end{document}
